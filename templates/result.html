<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Resume Analysis Result</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
   <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
   </head>
<body class="bg-light">

<div class="container py-5">
    <div class="card shadow p-4">
        <h2 class="mb-3">Resume Analysis Result</h2>

        <p><strong>Match Score:</strong> {{ score }}%</p>
        <div class="progress mb-3" style="height: 25px;">
            <div class="progress-bar bg-success" role="progressbar" style="width: {{ score }}%;" aria-valuenow="{{ score }}" aria-valuemin="0" aria-valuemax="100">
                {{ score }}%
            </div>
        </div>

        <p><strong>Matched Skills:</strong> {{ matched | join(', ') }}</p>
        <p><strong>Missing Skills:</strong>
            {% set missing = total - matched|length %}
            {{ missing }} missing
        </p>

        <hr>
        <h5>Extracted Resume Text:</h5>
        <pre style="white-space: pre-wrap;">{{ text }}</pre>

        <a href="/" class="btn btn-secondary mt-4">Check Another Resume</a>
    </div>
</div>
<hr class="my-4">
<h5>Skill Match Chart</h5>
<canvas id="skillChart" width="400" height="200">
   <script>
    const ctx = document.getElementById('skillChart').getContext('2d');
    const skillChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['Matched Skills', 'Missing Skills'],
            datasets: [{
                label: 'Skills Breakdown',
                data: [{{ matched|length }}, {{ total - matched|length }}],
                backgroundColor: ['#0d6efd', '#dc3545']
            }]
        },
        options: {
            responsive: true,
            scales: {
                y: {
                    beginAtZero: true,
                    stepSize: 1
                }
            }
        }
    });
</script>
</canvas>
<form action="/export/pdf" method="POST">
    <input type="hidden" name="score" value="{{ score }}">
    <input type="hidden" name="text" value="{{ text }}">
    <input type="hidden" name="total" value="{{ total }}">
    {% for skill in matched %}
        <input type="hidden" name="matched" value="{{ skill }}">
    {% endfor %}
    <button type="submit" class="btn btn-success mt-3">Download PDF Report</button>
</form>

</body>
</html>
